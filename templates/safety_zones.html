{% extends 'base.html' %}

{% block title %}Safety Zones - AlphaWolf{% endblock %}

{% block extra_css %}
<style>
    #map {
        height: 500px;
        width: 100%;
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
    }
    .zone-status-active {
        background-color: rgba(16, 185, 129, 0.2);
        border: 1px solid rgba(16, 185, 129, 0.4);
        color: var(--success-color);
    }
    .zone-status-inactive {
        background-color: rgba(239, 68, 68, 0.2);
        border: 1px solid rgba(239, 68, 68, 0.4);
        color: var(--danger-color);
    }
    .zone-marker {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="cyber-heading cyber-title-gradient">Safety Zones</h1>
        <div>
            <a href="{{ url_for('home') }}" class="btn cyber-btn-outline me-2">
                <i class="fas fa-arrow-left me-2"></i>Back to Home
            </a>
            <button class="btn cyber-btn" data-bs-toggle="modal" data-bs-target="#addZoneModal">
                <i class="fas fa-plus me-2"></i>Add Safety Zone
            </button>
        </div>
    </div>
    
    <div class="processor-bar mb-4"></div>
    
    <div class="row">
        <!-- Map Column -->
        <div class="col-lg-8 mb-4 mb-lg-0">
            <!-- Current Location Card -->
            <div class="cyber-card mb-4">
                <div class="cyber-card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Current Location</h5>
                    <span class="badge bg-success">Online</span>
                </div>
                <div class="cyber-card-body">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <div class="d-flex align-items-center mb-3">
                                <div class="cyber-badge cyber-badge-primary me-3">
                                    <i class="fas fa-map-marker-alt me-1"></i>
                                </div>
                                <div>
                                    <h6 class="mb-0">123 Maple Street, Downtown</h6>
                                    <small class="text-muted">Home Zone (Active)</small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <div class="cyber-badge cyber-badge-info me-3">
                                    <i class="fas fa-clock me-1"></i>
                                </div>
                                <div>
                                    <h6 class="mb-0">Last Updated</h6>
                                    <small class="text-muted">2 minutes ago</small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center">
                                <div class="cyber-badge cyber-badge-success me-3">
                                    <i class="fas fa-battery-three-quarters me-1"></i>
                                </div>
                                <div>
                                    <h6 class="mb-0">Device Battery</h6>
                                    <small class="text-muted">85% - 12h remaining</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 text-center">
                            <button class="btn cyber-btn mb-2 w-100">
                                <i class="fas fa-sync-alt me-2"></i>Update Location
                            </button>
                            <button class="btn cyber-btn-outline mb-2 w-100">
                                <i class="fas fa-map me-2"></i>Show Route Home
                            </button>
                            <button class="btn cyber-btn-outline w-100">
                                <i class="fas fa-phone me-2"></i>Contact Caregiver
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Map Card -->
            <div class="cyber-card">
                <div class="cyber-card-header">
                    <h5 class="mb-0">Safety Zones Map</h5>
                </div>
                <div class="cyber-card-body">
                    <div id="map" class="mb-3">
                        <!-- Map will be inserted here by JavaScript -->
                        <div class="d-flex justify-content-center align-items-center h-100">
                            <div class="text-center">
                                <div class="loading-spinner mb-3"></div>
                                <p class="cyber-text">Loading map...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex flex-wrap justify-content-around">
                        <div class="mb-2">
                            <span class="zone-marker" style="background-color: #10b981;"></span>
                            <small class="cyber-text">Safe Zone</small>
                        </div>
                        <div class="mb-2">
                            <span class="zone-marker" style="background-color: #f59e0b;"></span>
                            <small class="cyber-text">Caution Zone</small>
                        </div>
                        <div class="mb-2">
                            <span class="zone-marker" style="background-color: #ef4444;"></span>
                            <small class="cyber-text">Restricted Zone</small>
                        </div>
                        <div class="mb-2">
                            <span class="zone-marker" style="background-color: #3b82f6;"></span>
                            <small class="cyber-text">Current Location</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Zones List Column -->
        <div class="col-lg-4">
            <!-- Safety Zones Card -->
            <div class="cyber-card mb-4">
                <div class="cyber-card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">My Safety Zones</h5>
                    <span class="badge rounded-pill bg-primary">5</span>
                </div>
                <div class="cyber-card-body p-0">
                    <div class="safety-zone-list">
                        <!-- Home Zone -->
                        <div class="d-flex p-3 border-bottom cyber-border-bottom">
                            <div class="flex-shrink-0">
                                <div class="zone-status-active p-2 rounded-circle">
                                    <i class="fas fa-home"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Home</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked1" checked>
                                    </div>
                                </div>
                                <small class="text-muted">123 Maple Street, Downtown</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-success">Active</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1" data-bs-toggle="modal" data-bs-target="#editZoneModal">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Doctor's Office Zone -->
                        <div class="d-flex p-3 border-bottom cyber-border-bottom">
                            <div class="flex-shrink-0">
                                <div class="zone-status-active p-2 rounded-circle">
                                    <i class="fas fa-user-md"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Doctor's Office</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked2" checked>
                                    </div>
                                </div>
                                <small class="text-muted">457 Medical Plaza Dr</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-success">Active</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Grocery Store Zone -->
                        <div class="d-flex p-3 border-bottom cyber-border-bottom">
                            <div class="flex-shrink-0">
                                <div class="zone-status-active p-2 rounded-circle">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Grocery Store</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked3" checked>
                                    </div>
                                </div>
                                <small class="text-muted">789 Market Street</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-success">Active</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Community Center Zone -->
                        <div class="d-flex p-3 border-bottom cyber-border-bottom">
                            <div class="flex-shrink-0">
                                <div class="zone-status-active p-2 rounded-circle">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Community Center</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked4" checked>
                                    </div>
                                </div>
                                <small class="text-muted">321 Community Ave</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-success">Active</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Park Zone (Inactive) -->
                        <div class="d-flex p-3">
                            <div class="flex-shrink-0">
                                <div class="zone-status-inactive p-2 rounded-circle">
                                    <i class="fas fa-tree"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">City Park</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked5">
                                    </div>
                                </div>
                                <small class="text-muted">555 Green Park Way</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-danger">Inactive</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Restricted Zones Card -->
            <div class="cyber-card mb-4">
                <div class="cyber-card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Restricted Zones</h5>
                    <span class="badge rounded-pill bg-danger">2</span>
                </div>
                <div class="cyber-card-body p-0">
                    <div class="safety-zone-list">
                        <!-- Busy Highway Zone -->
                        <div class="d-flex p-3 border-bottom cyber-border-bottom">
                            <div class="flex-shrink-0">
                                <div class="zone-status-inactive p-2 rounded-circle">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Busy Highway</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked6" checked>
                                    </div>
                                </div>
                                <small class="text-muted">Interstate 95 Area</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-danger">Restricted</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Train Station Zone -->
                        <div class="d-flex p-3">
                            <div class="flex-shrink-0">
                                <div class="zone-status-inactive p-2 rounded-circle">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <div class="d-flex justify-content-between">
                                    <h6 class="mb-0">Train Station</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked7" checked>
                                    </div>
                                </div>
                                <small class="text-muted">Central Station Area</small>
                                <div class="d-flex justify-content-between mt-2">
                                    <small class="text-danger">Restricted</small>
                                    <div>
                                        <button class="btn btn-sm btn-outline-secondary me-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Alert Settings Card -->
            <div class="cyber-card">
                <div class="cyber-card-header">
                    <h5 class="mb-0">Alert Settings</h5>
                </div>
                <div class="cyber-card-body">
                    <div class="mb-3">
                        <label class="d-flex justify-content-between">
                            <span>Alert when leaving safe zone</span>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" checked>
                            </div>
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="d-flex justify-content-between">
                            <span>Alert when entering restricted zone</span>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" checked>
                            </div>
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="d-flex justify-content-between">
                            <span>Alert caregiver automatically</span>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" checked>
                            </div>
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="d-flex justify-content-between">
                            <span>Voice navigation assistance</span>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" checked>
                            </div>
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="d-flex justify-content-between">
                            <span>Automatic return route</span>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" checked>
                            </div>
                        </label>
                    </div>
                    <div class="d-grid">
                        <button class="btn cyber-btn">Save Settings</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Safety Zone Modal -->
<div class="modal fade" id="addZoneModal" tabindex="-1" aria-labelledby="addZoneModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addZoneModalLabel">Add New Safety Zone</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="zoneName" class="form-label">Zone Name</label>
                        <input type="text" class="form-control cyber-input" id="zoneName" placeholder="Enter zone name (e.g. Home, Work, etc.)">
                    </div>
                    
                    <div class="mb-3">
                        <label for="zoneAddress" class="form-label">Address</label>
                        <input type="text" class="form-control cyber-input" id="zoneAddress" placeholder="Enter full address">
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="zoneRadius" class="form-label">Zone Radius (meters)</label>
                            <input type="range" class="form-range" min="50" max="500" step="10" id="zoneRadius" value="200">
                            <div class="text-center">
                                <span id="radiusValue">200</span> meters
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="zoneType" class="form-label">Zone Type</label>
                            <select class="form-select cyber-input" id="zoneType">
                                <option value="safe">Safe Zone</option>
                                <option value="caution">Caution Zone</option>
                                <option value="restricted">Restricted Zone</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="zoneIcon" class="form-label">Zone Icon</label>
                        <div class="d-flex flex-wrap gap-2">
                            <button type="button" class="btn btn-outline-primary p-2">
                                <i class="fas fa-home fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-user-md fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-shopping-cart fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-utensils fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-users fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-tree fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-church fa-lg"></i>
                            </button>
                            <button type="button" class="btn btn-outline-secondary p-2">
                                <i class="fas fa-store fa-lg"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="zoneDescription" class="form-label">Description (Optional)</label>
                            <textarea class="form-control cyber-input" id="zoneDescription" rows="3"></textarea>
                        </div>
                        <div class="col-md-6">
                            <label for="zoneOptions" class="form-label">Options</label>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" value="" id="alertOnEnter" checked>
                                <label class="form-check-label" for="alertOnEnter">
                                    Alert when entering
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" value="" id="alertOnExit" checked>
                                <label class="form-check-label" for="alertOnExit">
                                    Alert when exiting
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" value="" id="notifyCaregiver">
                                <label class="form-check-label" for="notifyCaregiver">
                                    Notify caregiver
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="zoneActive" checked>
                                <label class="form-check-label" for="zoneActive">
                                    Zone active
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Preview on Map</label>
                        <div id="previewMap" style="height: 200px; width: 100%; border-radius: 8px;">
                            <!-- Preview map placeholder -->
                            <div class="d-flex justify-content-center align-items-center h-100 bg-dark">
                                <p class="cyber-text">Map preview will appear here</p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn cyber-btn">Save Zone</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Zone Modal (simplified version) -->
<div class="modal fade" id="editZoneModal" tabindex="-1" aria-labelledby="editZoneModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editZoneModalLabel">Edit Safety Zone</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Edit form would be similar to Add form, just pre-populated -->
                <p>Edit form would go here, similar to the Add Safety Zone form but with pre-populated fields.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn cyber-btn">Save Changes</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Simulate map functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Simple map placeholder
        setTimeout(() => {
            document.getElementById('map').innerHTML = `
                <div class="d-flex justify-content-center align-items-center h-100 bg-dark">
                    <div class="text-center">
                        <p class="mb-0 cyber-text">Map would display here with interactive safety zones.</p>
                        <p class="cyber-text">A third-party map API like Google Maps or Mapbox would be integrated here.</p>
                    </div>
                </div>
            `;
        }, 1500);
        
        // Update radius value display when slider changes
        const radiusSlider = document.getElementById('zoneRadius');
        const radiusValue = document.getElementById('radiusValue');
        
        if (radiusSlider && radiusValue) {
            radiusSlider.addEventListener('input', function() {
                radiusValue.textContent = this.value;
            });
        }
    });
</script>
{% endblock %}