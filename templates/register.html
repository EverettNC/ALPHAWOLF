{% extends "base.html" %}

{% block title %}Register for AlphaWolf{% endblock %}

{% block styles %}
<style>
  .register-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    background-color: white;
  }
  
  .register-header {
    text-align: center;
    margin-bottom: 2rem;
  }
  
  .register-header img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    margin-bottom: 1rem;
  }
  
  .form-select-user-type {
    margin-bottom: 1.5rem;
  }
  
  .btn-register {
    width: 100%;
    padding: 0.75rem;
    font-size: 1.1rem;
  }
  
  .auth-links {
    text-align: center;
    margin-top: 1.5rem;
  }
  
  .page-background {
    background: linear-gradient(to right, #3a7bd5, #3a6073);
    min-height: calc(100vh - 60px);
    display: flex;
    align-items: center;
    padding: 2rem 0;
  }
  
  .user-type-fields {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid #eee;
  }
</style>
{% endblock %}

{% block content %}
<div class="page-background">
  <div class="container">
    <div class="register-container">
      <div class="register-header">
        <img src="{{ url_for('static', filename='img/alphawolf_avatar.png') }}" alt="AlphaWolf Avatar" onerror="this.src='{{ url_for('static', filename='img/default_avatar.png') }}'">
        <h2>Create an Account</h2>
        <p class="text-muted">Join AlphaWolf for dementia and Alzheimer's support</p>
      </div>
      
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}" role="alert">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}
      
      <form method="POST" action="{{ url_for('register') }}" id="registerForm">
        <div class="form-select-user-type">
          <label for="user_type" class="form-label">I am registering as a:</label>
          <select class="form-select" id="user_type" name="user_type" required>
            <option value="patient">Patient</option>
            <option value="caregiver">Caregiver</option>
          </select>
        </div>
        
        <div class="mb-3">
          <label for="name" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="name" name="name" required>
        </div>
        
        <div class="mb-3">
          <label for="email" class="form-label">Email address</label>
          <input type="email" class="form-control" id="email" name="email" required>
          <div class="form-text">We'll never share your email with anyone else.</div>
        </div>
        
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <input type="password" class="form-control" id="password" name="password" required>
          <div class="form-text">Use at least 8 characters with a mix of letters, numbers and symbols.</div>
        </div>
        
        <div class="mb-3">
          <label for="confirm_password" class="form-label">Confirm Password</label>
          <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
        </div>
        
        <!-- Patient-specific fields -->
        <div class="user-type-fields" id="patient-fields">
          <h5>Patient Information</h5>
          
          <div class="mb-3">
            <label for="date_of_birth" class="form-label">Date of Birth</label>
            <input type="date" class="form-control" id="date_of_birth" name="date_of_birth">
          </div>
          
          <div class="mb-3">
            <label for="diagnosis" class="form-label">Diagnosis (optional)</label>
            <select class="form-select" id="diagnosis" name="diagnosis">
              <option value="">Prefer not to say</option>
              <option value="Early-stage Alzheimer's">Early-stage Alzheimer's</option>
              <option value="Mid-stage Alzheimer's">Mid-stage Alzheimer's</option>
              <option value="Vascular dementia">Vascular dementia</option>
              <option value="Lewy body dementia">Lewy body dementia</option>
              <option value="Frontotemporal dementia">Frontotemporal dementia</option>
              <option value="Mild cognitive impairment">Mild cognitive impairment</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div class="mb-3">
            <label for="emergency_contact" class="form-label">Emergency Contact (optional)</label>
            <input type="text" class="form-control" id="emergency_contact" name="emergency_contact" placeholder="Name and phone number">
          </div>
        </div>
        
        <!-- Caregiver-specific fields -->
        <div class="user-type-fields" id="caregiver-fields" style="display: none;">
          <h5>Caregiver Information</h5>
          
          <div class="mb-3">
            <label for="phone" class="form-label">Phone Number</label>
            <input type="tel" class="form-control" id="phone" name="phone">
          </div>
          
          <div class="mb-3">
            <label for="relationship_to_patient" class="form-label">Relationship to Patient</label>
            <select class="form-select" id="relationship_to_patient" name="relationship_to_patient">
              <option value="">Select relationship</option>
              <option value="Family Member - Spouse">Family Member - Spouse</option>
              <option value="Family Member - Child">Family Member - Child</option>
              <option value="Family Member - Sibling">Family Member - Sibling</option>
              <option value="Family Member - Other">Family Member - Other</option>
              <option value="Professional Caregiver">Professional Caregiver</option>
              <option value="Friend">Friend</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>
        
        <div class="mb-3 form-check">
          <input type="checkbox" class="form-check-input" id="terms_agree" required>
          <label class="form-check-label" for="terms_agree">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label>
        </div>
        
        <button type="submit" class="btn btn-primary btn-register">Create Account</button>
      </form>
      
      <div class="auth-links">
        <p>Already have an account? <a href="{{ url_for('login') }}">Sign in here</a></p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const userTypeSelect = document.getElementById('user_type');
    const patientFields = document.getElementById('patient-fields');
    const caregiverFields = document.getElementById('caregiver-fields');
    
    // Toggle appropriate fields based on user type selection
    userTypeSelect.addEventListener('change', function() {
      if (this.value === 'patient') {
        patientFields.style.display = 'block';
        caregiverFields.style.display = 'none';
      } else {
        patientFields.style.display = 'none';
        caregiverFields.style.display = 'block';
      }
    });
    
    // Form validation
    const registerForm = document.getElementById('registerForm');
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirm_password');
    
    registerForm.addEventListener('submit', function(event) {
      if (password.value !== confirmPassword.value) {
        event.preventDefault();
        alert('Passwords do not match!');
        confirmPassword.focus();
      }
    });
  });
</script>
{% endblock %}